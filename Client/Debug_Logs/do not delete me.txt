This is the fix for issue #22.